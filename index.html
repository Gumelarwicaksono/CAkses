<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Camera Akses</title>
    
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#000000">
    <link rel="apple-touch-icon" href="https://drive.google.com/thumbnail?id=1UI08JHA3Cl8HRbJRJ4mMBK-X_L2yor9K">
    
    <link rel="icon" type="image/png" href="https://drive.google.com/thumbnail?id=1UI08JHA3Cl8HRbJRJ4mMBK-X_L2yor9K">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Efek Studio Lighting */
        .filter-studio {
            filter: brightness(1.1) contrast(1.05) saturate(1.1);
            box-shadow: inset 0 0 100px rgba(255,255,255,0.2);
        }
        /* Efek Wajah Mulus (Blur halus) */
        .filter-smooth {
            filter: contrast(0.95) brightness(1.05) blur(0.5px);
        }
        video { transform: scaleX(-1); } /* Mirror untuk kamera depan */
        .unmirror { transform: scaleX(1); }
    </style>
</head>
<body class="bg-black h-screen flex items-center justify-center overflow-hidden">

    <div class="relative w-full max-w-md h-[80vh] bg-gray-900 rounded-3xl overflow-hidden shadow-2xl border-4 border-gray-800">
        
        <video id="video" autoplay playsinline class="w-full h-full object-cover transition-all duration-500"></video>

        <div id="studio-overlay" class="absolute inset-0 pointer-events-none opacity-0 transition-opacity duration-500 bg-gradient-to-b from-white/10 via-transparent to-black/20"></div>

        <button id="switch-btn" class="absolute top-5 right-5 bg-white/20 blur-bg p-3 rounded-full text-white hover:bg-white/40">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 7v6h-6"/><path d="M3 17V11h6"/><path d="M3 13a9 9 0 0 1 15-6.7L21 7"/><path d="M21 11a9 9 0 0 1-15 6.7L3 17"/></svg>
        </button>

        <div class="absolute bottom-24 left-0 right-0 flex justify-center gap-4">
            <div id="filter-menu" class="hidden flex bg-black/50 backdrop-blur-md p-2 rounded-2xl border border-white/20">
                <button onclick="applyFilter('original')" class="px-4 py-2 text-white text-sm font-medium hover:bg-white/20 rounded-xl transition">Original</button>
                <button onclick="applyFilter('smooth')" class="px-4 py-2 text-white text-sm font-medium hover:bg-white/20 rounded-xl transition">Mulus</button>
                <button onclick="applyFilter('studio')" class="px-4 py-2 text-white text-sm font-medium hover:bg-white/20 rounded-xl transition">Studio</button>
            </div>
        </div>

        <div class="absolute bottom-6 left-0 right-0 flex justify-around items-center px-10">
            <button id="toggle-filter" class="text-white flex flex-col items-center gap-1">
                <div class="p-3 bg-white/10 rounded-full"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="m15 12-8.5 8.5c-.83.83-2.17.83-3 0 0 0 0 0 0 0a2.12 2.12 0 0 1 0-3L12 9"/><path d="M17.64 15 22 10.64"/><path d="m15 19 3.5-3.5"/><path d="M13.5 13 17 9.5"/><path d="M17.2 5.8a2.12 2.12 0 1 0-3-3l-3.8 3.76"/><path d="m21.8 10.4-3.76-3.8c-.82-.82-2.13-.85-3-.03l-.07.07"/></svg></div>
                <span class="text-[10px]">Filter</span>
            </button>

            <button class="w-16 h-16 bg-white border-4 border-gray-400 rounded-full active:scale-90 transition-transform"></button>

            <div class="w-10"></div> </div>
    </div>

    <script>
        // --- PWA Service Worker Registration ---
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('sw.js')
                    .then(reg => console.log('Service Worker terdaftar!', reg))
                    .catch(err => console.error('Gagal daftar Service Worker:', err));
            });
        }

        const video = document.getElementById('video');
        const switchBtn = document.getElementById('switch-btn');
        const filterMenu = document.getElementById('filter-menu');
        const toggleFilterBtn = document.getElementById('toggle-filter');
        const studioOverlay = document.getElementById('studio-overlay');

        let currentFacingMode = "user";
        let stream = null;

        // Fungsi Memulai Kamera
        async function startCamera(facingMode) {
            if (stream) {
                stream.getTracks().forEach(track => track.stop());
            }

            try {
                const constraints = {
                    video: { facingMode: facingMode }
                };
                stream = await navigator.mediaDevices.getUserMedia(constraints);
                video.srcObject = stream;
                
                // Mirroring hanya untuk kamera depan
                if(facingMode === "user") {
                    video.style.transform = "scaleX(-1)";
                } else {
                    video.style.transform = "scaleX(1)";
                }
            } catch (err) {
                console.error("Gagal akses kamera: ", err);
                alert("Mohon izinkan akses kamera.");
            }
        }

        // Switch Kamera
        switchBtn.addEventListener('click', () => {
            currentFacingMode = (currentFacingMode === "user") ? "environment" : "user";
            startCamera(currentFacingMode);
        });

        // Show/Hide Menu Filter
        toggleFilterBtn.addEventListener('click', () => {
            filterMenu.classList.toggle('hidden');
        });

        // Logika Filter
        function applyFilter(type) {
            video.className = "w-full h-full object-cover transition-all duration-500";
            studioOverlay.style.opacity = "0";

            if (type === 'smooth') {
                video.classList.add('filter-smooth');
            } else if (type === 'studio') {
                video.classList.add('filter-studio');
                studioOverlay.style.opacity = "1";
            }
            // 'original' tidak menambah class apa-pun
        }

        // Jalankan kamera pertama kali
        startCamera(currentFacingMode);
    </script>
</body>
                                                              </html>
    
